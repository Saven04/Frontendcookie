<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Latest News</title>
    <link rel="stylesheet" href="./public/styles/news.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="#">News Portal</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto align-items-center">
                    <!-- Profile Picture Dropdown -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="profileDropdown" role="button" data-bs-toggle="dropdown">
                            <img src="default-profile.png" alt="Profile" id="profilePic" class="rounded-circle" width="35" height="35">
                            <span class="ms-2">User</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#profileModal">Update Profile</a></li>
                            <li><a class="dropdown-item" href="#" id="themeToggle">Toggle Theme</a></li>
                            <li><a class="dropdown-item" href="#" id="cookieSettings">Cookie Settings</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item text-danger" href="#" id="logout">Logout</a></li>
                        </ul>
                    </li>

                    <!-- Settings Dropdown -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="settingsDropdown" role="button" data-bs-toggle="dropdown">
                            ⚙️ Settings
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#profileModal">Update Profile</a></li>
                            <li><a class="dropdown-item" href="#" id="updateEmail">Update Email</a></li>
                            <li><a class="dropdown-item" href="#" id="updatePassword">Update Password</a></li>
                            <li><a class="dropdown-item" href="#" id="themeToggle">Theme</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item text-danger" href="#" id="logout">Logout</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Profile Update Modal -->
    <div class="modal fade" id="profileModal" tabindex="-1" aria-labelledby="profileModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="profileModalLabel">Update Profile</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="profileForm">
                        <div class="mb-3">
                            <label for="username" class="form-label">Username</label>
                            <input type="text" class="form-control" id="username">
                        </div>
                        <div class="mb-3">
                            <label for="profilePicUpload" class="form-label">Profile Picture</label>
                            <input type="file" class="form-control" id="profilePicUpload">
                        </div>
                        <button type="submit" class="btn btn-primary">Save Changes</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    
    <!-- News Categories -->
    <div class="container mt-3">
        <h2>Latest News</h2>
        <div class="btn-group" role="group">
            <button class="btn btn-primary category-btn" data-category="general">General</button>
            <button class="btn btn-secondary category-btn" data-category="technology">Technology</button>
            <button class="btn btn-secondary category-btn" data-category="sports">Sports</button>
            <button class="btn btn-secondary category-btn" data-category="business">Business</button>
        </div>
    </div>

    <!-- Search Bar -->
    <div class="container mt-3">
        <input type="text" id="searchInput" class="form-control" placeholder="Search news...">
    </div>

    <!-- News Section -->
    <div class="container mt-3">
        <div id="newsContainer" class="row"></div>
    </div>






<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
    // Handle Profile Update Modal
    const profileForm = document.getElementById("profileForm");
    const usernameInput = document.getElementById("username");
    const profilePicUpload = document.getElementById("profilePicUpload");
    const profilePic = document.getElementById("profilePic");

    profileForm.addEventListener("submit", function (event) {
        event.preventDefault();
        const newUsername = usernameInput.value.trim();

        if (newUsername) {
            document.querySelector("#profileDropdown span").textContent = newUsername;
        }

        if (profilePicUpload.files.length > 0) {
            const file = profilePicUpload.files[0];
            const reader = new FileReader();

            reader.onload = function (e) {
                profilePic.src = e.target.result;
            };

            reader.readAsDataURL(file);
        }

        // Close the modal
        const profileModal = new bootstrap.Modal(document.getElementById("profileModal"));
        profileModal.hide();
    });

    // Handle Theme Toggle
    const themeToggle = document.querySelectorAll("#themeToggle");

    themeToggle.forEach(toggle => {
        toggle.addEventListener("click", function () {
            document.body.classList.toggle("bg-dark");
            document.body.classList.toggle("text-light");

            const isDarkMode = document.body.classList.contains("bg-dark");
            localStorage.setItem("theme", isDarkMode ? "dark" : "light");
        });
    });

    // Apply saved theme
    if (localStorage.getItem("theme") === "dark") {
        document.body.classList.add("bg-dark", "text-light");
    }

    // Handle News Category Selection
    const categoryButtons = document.querySelectorAll(".category-btn");
    categoryButtons.forEach(button => {
        button.addEventListener("click", function () {
            categoryButtons.forEach(btn => btn.classList.remove("btn-primary"));
            this.classList.add("btn-primary");

            fetchNews(this.dataset.category);
        });
    });

    // Handle Search
    document.getElementById("searchInput").addEventListener("input", function () {
        const query = this.value.toLowerCase();
        filterNews(query);
    });

    // Fetch news function
    function fetchNews(category) {
        // Placeholder function – integrate with a real API
        document.getElementById("newsContainer").innerHTML = `<p>Loading ${category} news...</p>`;
        setTimeout(() => {
            document.getElementById("newsContainer").innerHTML = `<p>${category} news loaded successfully!</p>`;
        }, 1000);
    }

    // Filter news function (Placeholder)
    function filterNews(query) {
        console.log("Searching for:", query);
        // Implement actual search filtering here
    }
});
</script>
<script src="./public/src/news.js"></script>
<script src="supabase.js"></script>
<script src="routes.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
